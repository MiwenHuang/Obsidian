### 1. 为什么析构函数必须是虚函数
析构函数必须是虚函数的主要原因涉及到C++中的多态性和继承。

当你使用继承时，基类指针可以指向派生类的对象。如果基类没有虚析构函数，当通过基类指针删除一个指向派生类对象的实例时，只会调用基类的析构函数，而不会调用派生类的析构函数。这可能导致派生类的资源没有得到正确释放，从而引发内存泄漏。
```C++
#include <iostream>
class Base {
public:
    ~Base() {
        // 在基类的析构函数中释放资源
        std::cout<<"基类析构函数调用"<<std::endl;
    }
};

class Derived : public Base {
public:
    ~Derived() {
        // 在派生类的析构函数中释放额外的资源
         std::cout<<"派生类析构函数调用"<<std::endl;
    }
};

int main() {
    Base* ptr = new Derived;
    delete ptr;  // 如果~Base()不是虚函数，将只调用Base的析构函数，而不调用Derived的析构函数
    return 0;
}

```
![[Pasted image 20231206155710.png]]

![[Pasted image 20231206155825.png]]

### 2. 为什么C++默认的析构函数不是虚函数
当类中有虚成员函数时，类会自动生成虚函数表和虚表指针，虚表指针指向虚函数表。每个类都有自己的虚函数表，虚函数表的作用就是保存本类中虚函数的地址，我们可以把虚函数表形象地看成一个数组，这个数组的每个元素存放的就是各个虚函数的地址。

这样一来，就会占用额外的内存，当定义的类不被其他类继承时，这种内存开销无疑是浪费的

### 3. 静态函数和虚函数的区别
我们指导类的静态函数是没有this指针的，也就是静态函数不属于对象，而是属于类。静态函数只有唯一一份，因此它的地址固定不变，所以在编译的时候就确定了运行时机，属于静态绑定。

但是虚函数就不一样了，当类中有虚函数的时候，类会自动生成虚函数表。虚函数表就是一个数组，每个元素存放的都是各个虚函数的地址。当基类指针指向派生类的对象的时候，代码在编译期间只对语法进行检测，但编译器无法得知这个指针调用的是那个函数，只有在程序运行的时候通过指针查看对象的虚函数表才能确定调用哪一个虚函数。简单来说就是 虚函数在运行的时候动态绑定。

### 4. 重载和重写
`重写`：
是指**派生类**中存在重写函数，函数名，参数，返回值类型必须和基类中被重写的函数一样，只是它们的函数体不一样，被重写的函数必须用virtual修饰
`重载`：
是指函数名相同，函数参数不同，不关心返回值类型
函数重载是指同一可访问区内被声明的几个具有不同参数列（参数的类型，个数，顺序不同）的同名函数，根据参数列表确定调用哪个函数，重载不关心函数返回类型

### 5. 虚函数表具体怎么实现运行是多态？

![[Pasted image 20231017192822.png]]

当定义一个指向派生类的基类指针，用指针访问基类中的某个函数时，如果该函数不是虚函数, 直接调用基类中的这个函数；如果是虚函数, 则查找虚函数表, 并进行后续的调用。编译器在编译时给类创建一个虚函数表，同一个类的所有实例共用同一份虚函数表，但不同的类实例中各自保存一个虚表指针，编译器会在构造函数中插入一段代码，这段代码用来给虚表指针赋值，虚表指针里存放的就是虚函数表的地址，这个虚表指针的内容在程序运行期间才能决定，也就是所谓的“动态绑定”。，**当派生类对象重写基类的虚函数时，基类的虚函数表中对应的虚函数的地址就会被派生类的虚函数地址覆盖**，当基类指针调用虚函数时，程序会通过虚函数表找到正确的虚函数地址，并调用相应的函数
![[Pasted image 20231206164640.png]]

### 6. 构造函数有几种，分别什么作用
构造函数的特点：
1. 函数名和类名必须一样，没有返回值
2. 构造函数可以重载
3. 当没有显式的定义构造函数时，系统会自己生成默认的构造函数

默认构造函数、普通构造函数、拷贝构造函数
1. 默认构造函数：没有参数的构造函数，如果在类中没有显式定义构造函数，编译器类new的内存，当删除基类指针时，并不是去删除继承类的内存，也就是说并没有去调用继承类的析构函数，很明显这不是我们想要的清理方式，我们希望是清理掉继承类内存和基类的内存，所以这个时候就需要析构函会自动生成一个默认构造函数。
主要作用是初始化对象的成员变量为默认值，确保对象创建后是可用的。

2. 普通构造函数：带有参数的构造函数，用于在创建对象时传递参数并初始化对象的成员变量。
主要作用是允许在创建对象时为对象提供不同的初值。

3. 拷贝构造函数用于在创建对象时，通过复制另一个对象的值来初始化新对象。它通常采用另一个对象的引用作为参数，然后复制该对象的成员变量的值到新对象。拷贝构造函数主要用于创建一个新对象，其成员变量与现有对象相同。



### 7. 只定义析构函数，会自动生成哪些构造函数
编译器会自动生成拷贝构造函数和默认构造函数

### 8. 说说一个类，默认会生成哪些函数
无参构造函数 拷贝构造函数 析构函数(非虚)

### 9. c++对象的初始化顺序，有多重继承情况下的顺序
父类构造函数-》成员类对象构造函数-》自身构造函数

